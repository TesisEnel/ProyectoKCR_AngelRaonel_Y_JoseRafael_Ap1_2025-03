@page "/seleccion-servicio"
@layout ClientLayout
@using System.Threading
@inject NavigationManager navigationManager
@rendermode InteractiveServer

<div class="servicio-container">

    <img src="/Img-Vector/Union-1.svg" class="vector-decor top-left" />
    <img src="/Img-Vector/Union-2.svg" class="vector-decor top-right" />
    <img src="/Img-Vector/Union.svg" class="vector-decor bottom-left" />
    <img src="/Img-Vector/Union-2.svg" class="vector-decor bottom-right" />

    <div class="center-content">
        <h2 class="cliente-nombre">@NombreParaMostrar</h2>
        <h3 class="titulo-instruccion">SERVICIO A SOLICITAR:</h3>

        <div class="botones-wrapper">
            <button class="btn-servicio btn-express" @onclick="() => AbrirModal(true)">
                Servicio Exprés
                <span class="icon-suffix">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round">
                        <path d="M4 12H20M4 6H16M4 18H12" />
                    </svg>
                </span>
            </button>

            <button class="btn-servicio btn-diseno" @onclick="() => AbrirModal(false)">
                Diseño y Edición
            </button>
        </div>

        <button class="btn-volver" @onclick="IrAtras">VOLVER</button>
    </div>

    @if (mostrarModalExpres || mostrarModalDiseno)
    {
        <div class="modal-backdrop" @onclick="CerrarModal">
            <div class="modal-window" @onclick:stopPropagation>

                <div class="modal-header">
                    <div class="header-logo">
                        <img src="/Img-Vector/logoKCR.png" alt="KCR" height="30" />
                    </div>
                    <h3 class="header-title">
                        @(mostrarModalExpres ? "Servicio Exprés" : "DISEÑO Y EDICION")
                    </h3>
                    <button class="btn-close-x" @onclick="CerrarModal">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round">
                            <path d="M18 6L6 18M6 6l12 12" />
                        </svg>
                    </button>
                </div>

                <div class="modal-body">
                    <h4 class="subtitulo-servicios">SERVICIOS:</h4>

                    <div class="watermark-bg">
                        <img src="/Img-Vector/logoKCR.png" alt="" />
                    </div>

                    <div class="grid-botones">
                        @if (mostrarModalExpres)
                        {
                            <button class="btn-grid">COPIA</button>
                            <button class="btn-grid">IMPRESIONES</button>
                            <button class="btn-grid">ENCUADERNADO</button>
                            <button class="btn-grid">ESCANER</button>
                            <button class="btn-grid">SERVICIOS MULTIPLES</button>
                            <button class="btn-grid">IMPRESION PLANOS PDF</button>
                        }
                        else
                        {
                            <button class="btn-grid">EDICION DE DISEÑO</button>
                            <button class="btn-grid">DISEÑO SUBLIMACION</button>
                            <button class="btn-grid">TARJETAS DE PRESENTACION</button>
                            <button class="btn-grid">FLYERS/MONTADO</button>
                            <button class="btn-grid">SERVICIOS MULTIPLES</button>
                            <button class="btn-grid">PLANOS AUTOCAD</button>
                        }
                    </div>
                </div>
            </div>
        </div>
    }

</div>

@code {
    [SupplyParameterFromQuery(Name = "nombreCliente")]
    public string? NombreRecibido { get; set; }
    public string NombreParaMostrar => string.IsNullOrEmpty(NombreRecibido) ? "Cliente" : NombreRecibido;

    // --- LÓGICA DE MODALES ---
    private bool mostrarModalExpres = false;
    private bool mostrarModalDiseno = false;

    private void AbrirModal(bool esExpres)
    {
        if (esExpres) mostrarModalExpres = true;
        else mostrarModalDiseno = true;
    }

    private void CerrarModal()
    {
        mostrarModalExpres = false;
        mostrarModalDiseno = false;
    }

    private void IrAtras()
    {
        navigationManager.NavigateTo("/cliente");
    }
}
